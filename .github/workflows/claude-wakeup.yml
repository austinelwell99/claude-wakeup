name: Claude Wakeup

on:
  schedule:
    # 6:05 AM US Central Standard Time (UTC-6) = 12:05 PM UTC
    # Note: During Daylight Saving Time (March-November), this will run at 7:05 AM CDT
    - cron: '5 12 * * *'

  # Allows manual trigger for testing from the Actions tab
  workflow_dispatch:

jobs:
  wakeup:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Ping Claude Code (Max Subscription)
        # Pinned to commit eaa832e (2024-12-19) for supply chain security
        uses: grll/claude-code-action@eaa832e2642dfd5ecf723e5d99fc72c8f291c9bc
        with:
          use_oauth: "true"
          claude_access_token: ${{ secrets.CLAUDE_ACCESS_TOKEN }}
          claude_refresh_token: ${{ secrets.CLAUDE_REFRESH_TOKEN }}
          claude_expires_at: ${{ secrets.CLAUDE_EXPIRES_AT }}
          secrets_admin_pat: ${{ secrets.SECRETS_ADMIN_PAT }}
          direct_prompt: "Say hello. This is a wakeup ping to start the daily usage timer."
          timeout_minutes: "2"
          github_token: ${{ secrets.GITHUB_TOKEN }}
