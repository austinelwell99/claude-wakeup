name: Claude Wakeup

on:
  schedule:
    # 6:05 AM US Central Standard Time (UTC-6) = 12:05 PM UTC
    # Note: During Daylight Saving Time (March-November), this will run at 7:05 AM CDT
    - cron: '5 12 * * *'

  # Allows manual trigger for testing from the Actions tab
  workflow_dispatch:

jobs:
  wakeup:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Ping Claude Code (Max Subscription)
        # Pinned to commit b3679dd for supply chain security
        # Using base action directly since it supports workflow_dispatch
        uses: grll/claude-code-base-action@b3679ddae1203efdad9431c743e29bc2a161e7c5
        with:
          prompt: "Say hello. This is a wakeup ping to start the daily usage timer."
          use_oauth: "true"
          claude_access_token: ${{ secrets.CLAUDE_ACCESS_TOKEN }}
          claude_refresh_token: ${{ secrets.CLAUDE_REFRESH_TOKEN }}
          claude_expires_at: ${{ secrets.CLAUDE_EXPIRES_AT }}
          secrets_admin_pat: ${{ secrets.SECRETS_ADMIN_PAT }}
          timeout_minutes: "2"
